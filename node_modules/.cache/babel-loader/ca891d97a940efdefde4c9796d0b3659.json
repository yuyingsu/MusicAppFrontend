{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\yuyin\\\\onedrive\\\\desktop\\\\MusicappFrontendDeployment\\\\src\\\\views\\\\Inbox.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Link } from \"react-router-dom\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Badge from '@material-ui/core/Badge';\nimport NotificationsIcon from '@material-ui/icons/Notifications';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Divider from '@material-ui/core/Divider';\nimport TextField from '@material-ui/core/TextField';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Avatar from '@material-ui/core/Avatar';\nimport Fab from '@material-ui/core/Fab';\nimport SendIcon from '@material-ui/icons/Send';\nimport { Navbar } from 'react-bootstrap';\nimport ColoredCircle from \"../components/ColoredCircle\";\nimport { Button } from 'reactstrap';\nimport Axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '100%'\n  },\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n    flexBasis: '33.33%',\n    flexShrink: 0\n  },\n  secondaryHeading: {\n    fontSize: theme.typography.pxToRem(15),\n    color: theme.palette.text.secondary\n  },\n  table: {\n    minWidth: 650\n  },\n  chatSection: {\n    width: '100%',\n    height: '80vh'\n  },\n  headBG: {\n    backgroundColor: '#e0e0e0'\n  },\n  borderRight500: {\n    borderRight: '1px solid #e0e0e0'\n  },\n  messageArea: {\n    height: '60vh',\n    overflowY: 'auto',\n    padding: 0\n  }\n}));\n\nfunction Inbox(props) {\n  _s();\n\n  const [friends, setFriends] = useState([]);\n  const [requests, setRequests] = useState([]);\n  const userSignInReducer = useSelector(state => state.userSignin);\n  const {\n    userInfo\n  } = userSignInReducer;\n  const allMessagesReducer = useSelector(state => state.allMessages);\n  const {\n    messages\n  } = allMessagesReducer;\n  const classes = useStyles();\n  const [expanded, setExpanded] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const [current, setCurrent] = useState(\"\");\n  const [onlineFriends, setOnlineFriend] = useState([]);\n  const history = useHistory();\n  useEffect(() => {\n    getPendingRequests();\n    props.socket.emit('online_friends');\n    props.socket.on('users', function (msg) {\n      setOnlineFriend(msg['users']);\n    });\n  }, []);\n  useEffect(() => {\n    window.localStorage.setItem('messages', JSON.stringify(messages));\n  }, [messages]);\n  useEffect(() => {\n    if (!userInfo) {\n      history.push('/signin');\n    }\n  }, [userInfo]);\n\n  const handleChange = panel => (event, isExpanded) => {\n    setExpanded(isExpanded ? panel : false);\n  };\n\n  async function getPendingRequests() {\n    try {\n      let response = await Axios.get(\"https://tangerinemusic.herokuapp.com/pendingrequests\", {\n        headers: {\n          \"Authorization\": ' Bearer ' + userInfo.access_token\n        }\n      });\n      let temp = [];\n      response.data.map(e => {\n        temp.push({\n          name: e.from_user_name,\n          id: e.from_user_id\n        });\n      });\n      setRequests(temp);\n    } catch (error) {\n      console.log(error.response);\n    }\n  }\n\n  async function getFriendLists() {\n    try {\n      let response = await Axios.get(\"https://tangerinemusic.herokuapp.com/friendlist\", {\n        headers: {\n          \"Authorization\": ' Bearer ' + userInfo.access_token\n        }\n      });\n      let temp = [];\n      response.data.map(e => {\n        if (e.user1_id == userInfo.user_id) {\n          if (onlineFriends.includes(e.user2_name)) {\n            temp.push({\n              name: e.user2_name,\n              online: true\n            });\n          } else {\n            temp.push({\n              name: e.user2_name,\n              online: false\n            });\n          }\n        } else {\n          if (onlineFriends.includes(e.user1_name)) {\n            temp.push({\n              name: e.user1_name,\n              online: true\n            });\n          } else {\n            temp.push({\n              name: e.user1_name,\n              online: false\n            });\n          }\n        }\n      });\n      setFriends(temp);\n    } catch (error) {\n      console.log(error.response);\n    }\n  }\n\n  async function acceptFriend(id) {\n    try {\n      let response = await Axios.post(\"https://tangerinemusic.herokuapp.com/acceptrequest/\" + id, {}, {\n        headers: {\n          \"Authorization\": ' Bearer ' + userInfo.access_token\n        }\n      });\n      getPendingRequests();\n    } catch (error) {\n      console.log(error.response);\n    }\n  }\n\n  const startChat = name => {\n    setCurrent(name);\n  };\n\n  const submitMessage = () => {\n    if (!onlineFriends.includes(current)) {\n      alert(\"This friend is not online currently.\");\n    } else {\n      props.socket.emit('private_message', {\n        'to': current,\n        'message': message,\n        'from': userInfo.username\n      });\n    }\n\n    setMessage(\"\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      minHeight: \"562px\",\n      marginTop: \"80px\"\n    },\n    className: classes.root,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginLeft: \"130px\",\n        marginTop: \"120px\",\n        marginRight: \"130px\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Accordion, {\n        expanded: expanded === 'panel1',\n        onChange: handleChange('panel1'),\n        children: [/*#__PURE__*/_jsxDEV(AccordionSummary, {\n          expandIcon: /*#__PURE__*/_jsxDEV(ExpandMoreIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 23\n          }, this),\n          \"aria-controls\": \"panel1bh-content\",\n          id: \"panel1bh-header\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            className: classes.heading,\n            children: \"Pending Friend Requests\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Badge, {\n            badgeContent: requests.length,\n            color: \"primary\",\n            style: {\n              display: \"flex\",\n              marginLeft: \"auto\"\n            },\n            children: /*#__PURE__*/_jsxDEV(NotificationsIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(AccordionDetails, {\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            children: /*#__PURE__*/_jsxDEV(List, {\n              children: requests.map(e => /*#__PURE__*/_jsxDEV(ListItem, {\n                button: true,\n                children: [/*#__PURE__*/_jsxDEV(ListItemIcon, {\n                  children: /*#__PURE__*/_jsxDEV(Avatar, {\n                    src: \"https://static.thenounproject.com/png/138580-200.png\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 193,\n                    columnNumber: 17\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 192,\n                  columnNumber: 13\n                }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n                  children: /*#__PURE__*/_jsxDEV(Link, {\n                    to: `/profile/${e.id}`,\n                    children: e.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 195,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 195,\n                  columnNumber: 13\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"contained\",\n                  color: \"primary\",\n                  align: \"right\",\n                  onClick: () => {\n                    acceptFriend(e.id);\n                  },\n                  children: \"Accept\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 13\n                }, this)]\n              }, \"RemySharp\", true, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 13\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginLeft: \"130px\",\n        marginRight: \"130px\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Accordion, {\n        expanded: expanded === 'panel2',\n        onChange: handleChange('panel2'),\n        onClick: getFriendLists,\n        children: [/*#__PURE__*/_jsxDEV(AccordionSummary, {\n          expandIcon: /*#__PURE__*/_jsxDEV(ExpandMoreIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 23\n          }, this),\n          \"aria-controls\": \"panel2bh-content\",\n          id: \"panel2bh-header\",\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            className: classes.heading,\n            children: \"Chat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(AccordionDetails, {\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            component: Paper,\n            className: classes.chatSection,\n            children: [/*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 3,\n              className: classes.borderRight500,\n              children: [/*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(List, {\n                children: friends.map(e => /*#__PURE__*/_jsxDEV(ListItem, {\n                  onClick: () => {\n                    startChat(e.name);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(ListItemIcon, {\n                    children: e.online ? /*#__PURE__*/_jsxDEV(ColoredCircle, {\n                      color: \"#34eb3a\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 221,\n                      columnNumber: 39\n                    }, this) : /*#__PURE__*/_jsxDEV(ColoredCircle, {\n                      color: \"#A9A9A9\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 221,\n                      columnNumber: 72\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 220,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n                    children: e.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 223,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 219,\n                  columnNumber: 21\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 13\n            }, this), current ? /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 9,\n              children: [/*#__PURE__*/_jsxDEV(List, {\n                className: classes.messageArea,\n                children: [/*#__PURE__*/_jsxDEV(Navbar, {\n                  bg: \"light\",\n                  variant: \"light\",\n                  children: /*#__PURE__*/_jsxDEV(Navbar.Brand, {\n                    children: current\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 231,\n                    columnNumber: 17\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 17\n                }, this), messages.map(e => /*#__PURE__*/_jsxDEV(ListItem, {\n                  children: userInfo && e.from == userInfo.username && e.to == current ? /*#__PURE__*/_jsxDEV(Grid, {\n                    container: true,\n                    children: [/*#__PURE__*/_jsxDEV(Grid, {\n                      item: true,\n                      xs: 12,\n                      align: \"right\",\n                      children: /*#__PURE__*/_jsxDEV(ListItemText, {\n                        children: e.date\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 237,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 236,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                      item: true,\n                      xs: 12,\n                      align: \"right\",\n                      children: /*#__PURE__*/_jsxDEV(ListItemText, {\n                        children: e.message\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 240,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 239,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 235,\n                    columnNumber: 29\n                  }, this) : userInfo && e.from == current && e.to == userInfo.username ? /*#__PURE__*/_jsxDEV(Grid, {\n                    container: true,\n                    children: [/*#__PURE__*/_jsxDEV(Grid, {\n                      item: true,\n                      xs: 12,\n                      align: \"left\",\n                      children: /*#__PURE__*/_jsxDEV(ListItemText, {\n                        children: e.date\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 245,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 244,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                      item: true,\n                      xs: 12,\n                      align: \"left\",\n                      children: /*#__PURE__*/_jsxDEV(ListItemText, {\n                        children: e.message\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 248,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 247,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 243,\n                    columnNumber: 29\n                  }, this) : null\n                }, \"1\", false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 25\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                style: {\n                  padding: '20px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 11,\n                  children: /*#__PURE__*/_jsxDEV(TextField, {\n                    id: \"outlined-basic-email\",\n                    label: \"Type Something\",\n                    fullWidth: true,\n                    value: message,\n                    name: \"message\",\n                    onChange: e => setMessage(e.target.value)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 257,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 256,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  xs: 1,\n                  align: \"right\",\n                  children: /*#__PURE__*/_jsxDEV(Fab, {\n                    color: \"primary\",\n                    \"aria-label\": \"add\",\n                    children: /*#__PURE__*/_jsxDEV(SendIcon, {\n                      onClick: submitMessage\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 261,\n                      columnNumber: 63\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 261,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 260,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 9,\n              children: /*#__PURE__*/_jsxDEV(Typography, {\n                style: {\n                  textAlign: \"center\",\n                  marginTop: \"200px\"\n                },\n                className: classes.heading,\n                children: \"Select a friend who is online to start chatting\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Inbox, \"2Bdn93I/KhPO9fHf9Jo5Zqqd2CA=\", false, function () {\n  return [useSelector, useSelector, useStyles, useHistory];\n});\n\n_c = Inbox;\nexport default Inbox;\n\nvar _c;\n\n$RefreshReg$(_c, \"Inbox\");","map":{"version":3,"sources":["C:/Users/yuyin/onedrive/desktop/MusicappFrontendDeployment/src/views/Inbox.js"],"names":["React","useEffect","useHistory","useState","useSelector","Link","makeStyles","Accordion","AccordionDetails","AccordionSummary","Typography","ExpandMoreIcon","Badge","NotificationsIcon","Paper","Grid","Divider","TextField","List","ListItem","ListItemIcon","ListItemText","Avatar","Fab","SendIcon","Navbar","ColoredCircle","Button","Axios","useStyles","theme","root","width","heading","fontSize","typography","pxToRem","flexBasis","flexShrink","secondaryHeading","color","palette","text","secondary","table","minWidth","chatSection","height","headBG","backgroundColor","borderRight500","borderRight","messageArea","overflowY","padding","Inbox","props","friends","setFriends","requests","setRequests","userSignInReducer","state","userSignin","userInfo","allMessagesReducer","allMessages","messages","classes","expanded","setExpanded","message","setMessage","current","setCurrent","onlineFriends","setOnlineFriend","history","getPendingRequests","socket","emit","on","msg","window","localStorage","setItem","JSON","stringify","push","handleChange","panel","event","isExpanded","response","get","headers","access_token","temp","data","map","e","name","from_user_name","id","from_user_id","error","console","log","getFriendLists","user1_id","user_id","includes","user2_name","online","user1_name","acceptFriend","post","startChat","submitMessage","alert","username","minHeight","marginTop","marginLeft","marginRight","length","display","from","to","date","target","value","textAlign"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Link } from \"react-router-dom\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Badge from '@material-ui/core/Badge';\nimport NotificationsIcon from '@material-ui/icons/Notifications';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Divider from '@material-ui/core/Divider';\nimport TextField from '@material-ui/core/TextField';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Avatar from '@material-ui/core/Avatar';\nimport Fab from '@material-ui/core/Fab';\nimport SendIcon from '@material-ui/icons/Send';\nimport { Navbar } from 'react-bootstrap';\nimport ColoredCircle from \"../components/ColoredCircle\";\nimport { Button } from 'reactstrap';\nimport Axios from \"axios\";\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n      width: '100%',\n    },\n    heading: {\n      fontSize: theme.typography.pxToRem(15),\n      flexBasis: '33.33%',\n      flexShrink: 0,\n    },\n    secondaryHeading: {\n      fontSize: theme.typography.pxToRem(15),\n      color: theme.palette.text.secondary,\n    },\n    table: {\n        minWidth: 650,\n      },\n      chatSection: {\n        width: '100%',\n        height: '80vh'\n      },\n      headBG: {\n          backgroundColor: '#e0e0e0'\n      },\n      borderRight500: {\n          borderRight: '1px solid #e0e0e0'\n      },\n      messageArea: {\n        height: '60vh',\n        overflowY: 'auto',\n        padding: 0\n      }\n  }));\n\n\nfunction Inbox(props) {\n    const [friends, setFriends] = useState([]);\n    const [requests, setRequests] = useState([]);\n    const userSignInReducer = useSelector((state) => state.userSignin);\n    const { userInfo } = userSignInReducer;\n    const allMessagesReducer = useSelector((state) => state.allMessages);\n    const { messages } = allMessagesReducer;\n    const classes = useStyles();\n    const [expanded, setExpanded] = useState(false);\n    const [message, setMessage] = useState(\"\");\n    const [current, setCurrent] = useState(\"\");\n    const [onlineFriends, setOnlineFriend] = useState([]);\n    const history = useHistory();\n\n    useEffect(() => {\n        getPendingRequests();\n        props.socket.emit('online_friends');\n        props.socket.on('users', function(msg) {\n            setOnlineFriend(msg['users']);\n       });\n    }, [])\n\n    useEffect(() => {\n        window.localStorage.setItem('messages', JSON.stringify(messages));\n    }, [messages])\n\n    useEffect(() => {\n      if(!userInfo){\n        history.push('/signin');\n      }\n    }, [userInfo])\n\n    const handleChange = (panel) => (event, isExpanded) => {\n      setExpanded(isExpanded ? panel : false);\n    };\n\n    async function getPendingRequests() {\n        try{\n        let response = await Axios.get(\"https://tangerinemusic.herokuapp.com/pendingrequests\", {\n            headers: {\n                \"Authorization\": ' Bearer ' + userInfo.access_token\n              }\n        });\n        let temp = [];\n        response.data.map(e=>{\n            temp.push({name: e.from_user_name, id: e.from_user_id});\n        });\n        setRequests(temp);\n        }catch(error){\n          console.log(error.response);\n        }\n      }\n\n      async function getFriendLists() {\n        try{\n        \n        let response = await Axios.get(\"https://tangerinemusic.herokuapp.com/friendlist\", {\n            headers: {\n                \"Authorization\": ' Bearer ' + userInfo.access_token\n              }\n        });\n        let temp = [];\n        response.data.map(e=>{\n            if(e.user1_id==userInfo.user_id){\n                if(onlineFriends.includes(e.user2_name)){\n                    temp.push({name: e.user2_name, online: true});\n                }else{\n                    temp.push({name: e.user2_name, online: false});\n                }\n            }else{\n                if(onlineFriends.includes(e.user1_name)){\n                    temp.push({name: e.user1_name, online: true});\n                }else{\n                    temp.push({name: e.user1_name, online: false});\n                }\n            }\n        });\n        setFriends(temp);\n        }catch(error){\n          console.log(error.response);\n        }\n      }\n\n      async function acceptFriend(id) {\n        try{\n        let response = await Axios.post(\"https://tangerinemusic.herokuapp.com/acceptrequest/\"+id, {}, {\n            headers: {\n                \"Authorization\": ' Bearer ' + userInfo.access_token\n              }\n        });\n        getPendingRequests();\n        }catch(error){\n          console.log(error.response);\n        }\n      }\n\n      const startChat = (name) => {\n        setCurrent(name);\n      }\n\n      const submitMessage = () =>{\n        if(!onlineFriends.includes(current)){\n          alert(\"This friend is not online currently.\");\n        }else{\n          props.socket.emit('private_message', {'to' : current, 'message' : message, 'from': userInfo.username});\n        }\n        setMessage(\"\");\n      }\n\n  return(\n    <div style={{minHeight:\"562px\",marginTop:\"80px\"}} className={classes.root}>\n        <div style={{marginLeft:\"130px\", marginTop:\"120px\", marginRight:\"130px\"}}>\n        <Accordion expanded={expanded === 'panel1'} onChange={handleChange('panel1')}>\n        <AccordionSummary\n          expandIcon={<ExpandMoreIcon />}\n          aria-controls=\"panel1bh-content\"\n          id=\"panel1bh-header\"\n        >\n          <Typography className={classes.heading}>Pending Friend Requests</Typography>\n          <Badge badgeContent={requests.length} color=\"primary\" style={{ display: \"flex\", marginLeft: \"auto\" }}>\n          <NotificationsIcon/>\n          </Badge>\n        </AccordionSummary>\n        <AccordionDetails>\n        <Grid item xs={12}>\n        <List>\n            {requests.map(e=>\n            <ListItem button key=\"RemySharp\">\n            <ListItemIcon>\n                <Avatar src=\"https://static.thenounproject.com/png/138580-200.png\"/>\n            </ListItemIcon>\n            <ListItemText><Link to={`/profile/${e.id}`}>{e.name}</Link></ListItemText>\n            <Button variant=\"contained\" color=\"primary\" align=\"right\" onClick={()=>{acceptFriend(e.id)}}>Accept</Button>\n            </ListItem>\n            )}\n        </List>\n        </Grid>\n        </AccordionDetails>\n      </Accordion>\n      </div>\n      <div style={{marginLeft:\"130px\", marginRight:\"130px\"}}>\n      <Accordion expanded={expanded === 'panel2'} onChange={handleChange('panel2')} onClick={getFriendLists}> \n        <AccordionSummary\n          expandIcon={<ExpandMoreIcon />}\n          aria-controls=\"panel2bh-content\"\n          id=\"panel2bh-header\"\n        >\n        <Typography className={classes.heading}>Chat</Typography>\n        </AccordionSummary>\n        <AccordionDetails>\n        <Grid container component={Paper} className={classes.chatSection}>\n            <Grid item xs={3} className={classes.borderRight500}>\n                <Divider />\n                <List>\n                    {friends.map(e=>\n                    <ListItem onClick={()=>{startChat(e.name)}}>\n                        <ListItemIcon>\n                            {e.online?<ColoredCircle color=\"#34eb3a\"/>:<ColoredCircle color=\"#A9A9A9\"/>}\n                        </ListItemIcon>\n                        <ListItemText>{e.name}</ListItemText>\n                    </ListItem>)}\n                </List>\n            </Grid>\n            {current?\n                <Grid item xs={9}>\n                <List className={classes.messageArea}>\n                <Navbar bg=\"light\" variant=\"light\">\n                <Navbar.Brand>{current}</Navbar.Brand>\n                </Navbar>\n                    {messages.map(e=>\n                        <ListItem key=\"1\">{userInfo && e.from==userInfo.username && e.to==current?\n                            <Grid container>\n                            <Grid item xs={12} align=\"right\">\n                                <ListItemText>{e.date}</ListItemText>\n                            </Grid>\n                            <Grid item xs={12} align=\"right\">\n                                <ListItemText>{e.message}</ListItemText>\n                            </Grid>\n                            </Grid>:userInfo && e.from==current && e.to==userInfo.username?\n                            <Grid container>\n                            <Grid item xs={12} align=\"left\">\n                                <ListItemText>{e.date}</ListItemText>\n                            </Grid>\n                            <Grid item xs={12} align=\"left\">\n                                <ListItemText>{e.message}</ListItemText>\n                            </Grid>\n                            </Grid>:null}\n                        </ListItem>)\n                    }\n                </List>\n                <Divider />\n                <Grid container style={{padding: '20px'}}>\n                    <Grid item xs={11}>\n                        <TextField id=\"outlined-basic-email\" label=\"Type Something\" fullWidth value={message} name=\"message\"\n                        onChange={e => setMessage(e.target.value)}/>\n                    </Grid>\n                    <Grid xs={1} align=\"right\">\n                        <Fab color=\"primary\" aria-label=\"add\"><SendIcon onClick={submitMessage}/></Fab>\n                    </Grid>\n                </Grid>\n                </Grid>:\n                <Grid item xs={9}>\n                    <Typography style={{textAlign:\"center\", marginTop:\"200px\"}} className={classes.heading}>\n                        Select a friend who is online to start chatting\n                    </Typography>\n                </Grid>\n                }\n                </Grid>\n        </AccordionDetails>\n      </Accordion>\n      </div>\n    </div>\n    );\n    }\n\nexport default Inbox;"]},"metadata":{},"sourceType":"module"}